import React, {createContext, useEffect, useState} from 'react';
import useGetRequest from "@/hooks/useGetRequest";
import Cookies from "js-cookie";
import {useRouter} from "next/router";

export const Information = createContext({})
const InformationProvider = ({children}) => {
    const {push} = useRouter()
    const [data, setData] = useState()


    useEffect(() => {
        const studentData = JSON.parse(localStorage.getItem('student'))
        setData(studentData)
    }, []);

    const [student,setStudent,setReload] = useGetRequest(true,data ? `/student-panel/ساخص` : null)

    const logout = () => {
        Cookies.remove('token')
        localStorage.removeItem('student')
        localStorage.removeItem('language')
        push('/auth/login')
    }
    return (<>
        <Information.Provider value={{student,setReload, logout}}>
            {student ? children : 'loading'}
        </Information.Provider>
    </>);
};

export default InformationProvider;